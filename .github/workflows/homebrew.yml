name: Homebrew
on: [pull_request]
jobs:
  install:
    runs-on: macos-latest
    strategy:
      matrix:
        formula:
          - python@2.7
          - python@3.4
          - python@3.5
          - python@3.6
          - python@3.9
    steps:
      - uses: actions/checkout@v2

      - name: Install OpenSSL 1.0
        run: brew install ./Formula/openssl@1.0.rb
        if: matrix.formula == 'python@3.4'

      - name: Install ${{ matrix.formula }}
        run: brew install -s -v ./Formula/${{ matrix.formula }}.rb

      - name: Test ${{ matrix.formula }}
        run: brew test ${{ matrix.formula }}

      - name: Audit ${{ matrix.formula }}
        run: brew audit --strict --online ${{ matrix.formula }}
